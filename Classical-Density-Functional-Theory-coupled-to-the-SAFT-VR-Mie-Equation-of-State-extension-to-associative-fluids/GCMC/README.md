```
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣤⣴⣶⡆⠀⣶⣶⣦⣤⣤⣄⠀⢠⣾⣿⣦
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⢰⣿⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⡄⠘⢿⣿⠟
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣾⣿⣧⠀⢻⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⣿⠂⢠⣠⣤⣶⣦⡀
                                    ⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣇⠈⢿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⠏⢀⣿⣿⣿⣿⣿⣿⣦⡀
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣿⣿⡆⠘⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⡏⠀⣾⣿⣿⣿⣿⣿⣿⡿⠋⢀
                                    ⠀⠀⠀⣴⣿⣦⡀⠙⢿⣿⣿⣿⣿⣿⣿⡄⠸⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⡟⠀⣼⣿⣿⣿⣿⣿⣿⠟⢀⣴⣿⣧
                                    ⠀⠀⣼⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣿⣷⡀⢹⣿⣿⣿⡇⠀⣿⣿⣿⡿⠁⣰⣿⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣧
                                    ⠀⣼⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣧⠀⢻⣿⣿⡇⠀⣿⣿⣿⠃⢰⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⠀⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣇⠀⢿⣿⡇⠀⣿⣿⠇⢠⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠃
                                    ⣼⣶⣤⣄⡈⠙⠛⠿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⡆⠈⠛⠃⠀⠛⠋⠀⣾⣿⠟⠁⣠⣾⣿⣿⣿⣿⡿⠿⠛⠉⣀⣠⣴⣶⡄
                                    ⣿⣿⣿⣿⣿⣿⣶⣤⣀⡉⠙⠻⢿⣿⣿⣦⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⠁⢠⣾⣿⣿⠿⠛⠋⢁⣠⣴⣶⣿⣿⣿⣿⣿⣿⡀
                                    ⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣤⣀⠉⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠋⢁⣀⣤⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁ ⣠⣶⣄
                                    ⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⢻⣿⣿⡿
                                    ⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠂⠀⠙⠋
                                    ⠀⠀⠘⣿⣿⣿⣿⣿⠿⠛⠋⢁⣠⣤⣶⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋
                                    ⠀⠀⠀⠘⠟⠋⢉⣀⣤⣶⣿⣿⣿⣿⠟⠁⣠⣦⣄⡀⠀⠀⠀⠀⠀⠀⣤⣦⡈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠁
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⠟⠁⣠⣾⣿⣿⣿⣿⣿⣶⣶⣾⣧⠀⢻⣿⣿⣦⡈⠻⣿⣿⣿⣿⡿⠟⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠙⠿⣿⡟⠁⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠈⠿⢿⣿⣿⣦⡈⠻⠛⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠺⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⢀⣤⣤⡈⠙⠋⠁
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠻⠿⠿⠿⠿⠿⠿⠇⠀⣿⣿⣿⡇
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠋

                         /██   /██   /██   /██   /██████    /██████     /██████    /██      /██   /███████
                        | ██  | ██  | ███ | ██  |_  ██_/   /██__  ██   /██__  ██  | ███    /███  | ██__  ██
                        | ██  | ██  | ████| ██    | ██    | ██  \__/  | ██  \ ██  | ████  /████  | ██  \ ██
                        | ██  | ██  | ██ ██ ██    | ██    | ██        | ████████  | ██ ██/██ ██  | ███████/
                        | ██  | ██  | ██  ████    | ██    | ██        | ██__  ██  | ██  ███| ██  | ██____/
                        | ██  | ██  | ██\  ███    | ██    | ██    ██  | ██  | ██  | ██\  █ | ██  | ██
                        |  ██████/  | ██ \  ██   /██████  |  ██████/  | ██  | ██  | ██ \/  | ██  | ██
                         \______/   |__/  \__/  |______/   \______/   |__/  |__/  |__/     |__/  |__/
```
<p align="right"><b><sub><a href="https://github.com/LESC-Unicamp/Supplementary-materials/blob/main/Classical-Density-Functional-Theory-coupled-to-the-SAFT-VR-Mie-Equation-of-State-extension-to-associative-fluids/GCMC/CHANGELOG.md">Version: 1.0.0</a></sub></b></p>

<p align="center"><b>Authors</b></p>
<p align="center">
André de Freitas Gonçalves<br>
Nathan Barros de Souza<br>
Luís Fernando Mercier Franco<br></p>

# <p align="center"><b>Grand Canonical Monte Carlo</b> (GCMC):<br> associative fluids</p>

## Contents
1. [Disclaimer](#disclaimer)
2. [Overview](#overview)
3. [Features](#features)
4. [Language](#language)
5. [Building and Compiling](#installation)
6. [Data Input](#datainput)
7. [Files](#filesandfolders)
8. [Running the Code](#running)
9. [Reporting Errors](#reporting)
10. [Citing Us](#citation)

## <a name="disclaimer"></a>Disclaimer
<p align="justify">
The authors make no warranties about the use of this software. The authors hold no liabilities for the use of this software. The authors do not 
 recommend the use of this software whatsoever. The algorithm is made freely available to assist researchers in simulation studies involving associative fluids.
 All information contained herein regarding any specific methodology does not constitute or imply its endorsement or recommendation by the authors.
</p>

## <a name="overview"></a>Overview
<p align="justify">
  This Grand Canonical Monte Carlo (GCMC) algorithm was designed to evaluate the density profile of an associative fluid (water) confined in two-dimensional slit pores (graphite). The dispersive fluid–fluid interactions are described by the Mie potential, while the highly directional associative interactions (hydrogen bonding) are modeled using a spherical square-well potential. The solid–fluid interaction is represented by the Steele potential.
</p>

<p align="justify">
The figures below illustrate the geometry of the simulation box containing water molecules confined within a slit pore of width <b>30 Å</b> (along the <i>z</i>-direction) at a reduced chemical potential &mu;<sup>*</sup> = &mu; / (kT) = −14.364, where <em>k</em> is the Boltzmann constant and <em>T</em> is the system temperature.
</p>

| |
|:---:|
| |
| **Front View** showing water molecules within an orthorhombic simulation box confined along the _z_-direction. |
| ![paper_front](https://github.com/user-attachments/assets/d6294aee-85a4-4df4-be2b-117a9c04316a) |
| **Top View** of the simulation box highlighting its square cross-section. |
| ![paper_top](https://github.com/user-attachments/assets/fea7664f-8719-463e-ba6b-4a11f84a3728) |
| |

## <a name="features"></a>Features
<p align="justify">
The following features are supported in the current version:
</p>

1. Initial Configurations
    - Random Structure

2. Ensembles
    - Grand Canonical (&mu;VT)

4. Moves
    - Translation (NVT)
    - Rotation (NVT)
    - Insertion (&mu;VT)
    - Deletion (&mu;VT)

5. Force Fields
    - Mie (for dispersive fluid-fluid interactions)
    - Square Well (for associative fluid-fluid interactions)
    - Steele (for solid-fluid interactions)

## <a name="language"></a>Language
<p align="justify">
  The main program, subroutines, and modules contain some explanatory comments and are mainly written in Fortran 95. The user can look for more information on Fortran language <a href="https://docs.oracle.com/cd/E19957-01/806-3591/C_f95.html">here</a>.
</p>

## <a name="installation"></a>Building and Compiling
<p align="justify">
  Firstly, you must clone this GitHub repository using the command below:
</p>

```
> git clone https://github.com/LESC-Unicamp/Supplementary-materials/
```

<p align="justify">
  After that, change to the repository directory on your device and open the <code>/src/</code> folder:
</p>

```
cd Supplementary-materials/Classical-Density-Functional-Theory-coupled-to-the-SAFT-VR-Mie-Equation-of-State-extension-to-associative-fluids/GCMC/src/
```

<p align="justify">
  The <code>/src/</code> folder contains a 'Makefile' that you can use to compile the standard version of the code.
</p>

<p align="justify">
  To compile it, first remove any object and module files using the <i>clean</i> command:
</p>
  
```
> make clean
```

<p align="justify">
  Then, to compile the source code, run the command below:
</p>

| **Compilation type** | **Command** |
|:---:|:---:|
| <a href="https://github.com/LESC-Unicamp/Supplementary-materials/blob/main/Classical-Density-Functional-Theory-coupled-to-the-SAFT-VR-Mie-Equation-of-State-extension-to-associative-fluids/GCMC/src/makefile">Standard</a> | ```make -f makefile``` |

<p align="justify">
  Please note that although the compilation includes a parallelization option (OpenMP), it has not yet been implemented in the code. This feature is reserved for future versions.
</p>

<p align="justify">
  This command will produce an executable named <code>gcmc_mie_assoc.out</code>, which can be found in the folder <code>/bin/</code> in the GCMC repository directory. Before running the program, there are a few initialization variables and options you need to set up.
</p>

## <a name="datainput"></a>Data Input

<p align="justify">
  Apart from the executable file, the <code>/bin/</code> folder contains an initialization file named <code>parameters.ini</code> that must be configured. The available options are straightforward and include comments; however, we provide a brief explanation of some of them below.
</p>

| Name<br> ______________________ | String Name<br> _________________________________ | Definition<br> _______________________________ | Options<br> _________________________________________________ |
|:---:|:---:| --- | --- |
| Number of particles | <code>NUMBER_PARTICLES</code> | Represents the initial number of particles/molecules (N) in GCMC simulations | Any positive, non-zero <code>INTEGER</code> number |
| Number density | <code>DENSITY</code> | Represents the initial number density (&rho;) of the system in [1/Å³] | Any positive, non-zero <code>FLOAT</code> number |
| Temperature | <code>TEMPERATURE</code> | Represents the temperature (T) of the system in [K] | Any positive, non-zero <code>FLOAT</code> number |
| Reduced chemical potential | <code>RED_CHEMICAL_POT</code> | Represents the target reduced chemical potential (&mu;<sup>*</sup>) of the system in kT units | Any <code>FLOAT</code> number |
| Pore width | <code>PORE_WIDTH</code> | Represents the width in [Å] of the simulation box along the _z_-direction (confinement) | Any positive <code>FLOAT</code> number |
| Pore height | <code>PORE_HEIGHT</code> | Represents the height in [Å] of the simulation box along the _x_-direction (PBC)<br>**NOTE**: The length along the _y_-direction is calculated from the provided initial number density | Any positive <code>FLOAT</code> number |
| Solid density | <code>SOLID_DENSITY</code> | Represents the density of the solid phase (graphite) in [1/Å³] | Any positive <code>FLOAT</code> number |
| Interlayer spacing | <code>INTERLAYER_SPACING</code> | Represents the distance in [Å] between adjacent graphene layers in the solid phase | Any positive <code>FLOAT</code> number |
| Size parameter<br>(solid) | <code>SIGMA_SOLID</code> | Represents the size parameter of the solid in [Å]<br>**NOTE**: used in the Lorentz combining rule to obtain the solid-fluid interaction parameter (Mie potential) | Any positive <code>FLOAT</code> number |
| Energy parameter<br>(solid) | <code>EPSILON_SOLID</code> | Represents the energy parameter (divided by _k_) of the solid in [K]<br>**NOTE**: used in the Berthelot combining rule to obtain the solid-fluid interaction parameter (Mie potential) | Any positive <code>FLOAT</code> number |
| Size parameter<br>(fluid) | <code>SIGMA_FLUID</code> | Represents the size parameter of the fluid in [Å] | Any positive <code>FLOAT</code> number |
| Energy parameter<br>(fluid) | <code>EPSILON_FLUID</code> | Represents the energy parameter (divided by _k_) of the fluid in [K] | Any positive <code>FLOAT</code> number |
| Cutoff radius<br>(Mie potential) | <code>CUTOFF_RADIUS_MIE</code> | Represents the cutoff radius in [Å] for dispersive fluid-fluid interactions described by the Mie potential | Any positive <code>FLOAT</code> number |
| Attractive range<br>(Mie potential) | <code>ARANGE</code> | Represents the attractive exponent of the Mie potential | Any positive <code>FLOAT</code> number |
| Repulsive range<br>(Mie potential) | <code>RRANGE</code> | Represents the repulsive exponent of the Mie potential | Any positive <code>FLOAT</code> number |
| Energy parameter<br>(association) | <code>EPSILON_WATER</code> | Represents the energy parameter (divided by _k_) of the fluid (association) in [K] | Any positive <code>FLOAT</code> number |
| Cutoff radius<br>(SW potential) | <code>CUTOFF_RADIUS_WATER</code> | Represents a cutoff scaling factor for associative fluid-fluid interactions described by the square-well potential<br>**NOTE**: the scaling factor is multiplied by the size parameter of the fluid | Any positive <code>FLOAT</code> number |
| Association sites<br>(position) | <code>RADIUS_SITES</code> | Represents a scaling factor that positions the association sites inside a sphere of diameter <code>SIGMA_FLUID</code><br>**NOTE**: the scaling factor is multiplied by the size parameter of the fluid | Any positive <code>FLOAT</code> number |
| Association sites<br>(angle) | <code>WATER_ANGLE</code> | Represents the angle in degrees between association sites of the same type | Any positive <code>FLOAT</code> number in between 0 and 180 degrees |
| Number of simulation cycles | <code>MC_CYCLES</code> | Represents the total number of simulation cycles<br>**NOTE**: each cycle contemplates a single movement type | Any positive <code>INTEGER</code> number |
| Number of equilibration cycles | <code>N_EQUILIBRATION</code> | Represents the number of equilibration cycles | Any positive <code>INTEGER</code> number less than <code>MC_CYCLES</code> |
| Number of equilibration cycles<br>(random configuration) | <code>N_EQUILIBRATION_RANDOM</code> | Represents the number of equilibration cycles in the random configuration routine | Any positive <code>INTEGER</code> number less than <code>MC_CYCLES</code> |
| Adjustment frequency | <code>N_ADJUST</code> | Represents how often (every <code>N_ADJUST</code> cycles) the maximum displacement parameters are adjusted during equilibration | Any positive <code>INTEGER</code> number |
| Saving frequency | <code>N_SAVE</code> | Represents how often (every <code>N_SAVE</code> cycles) results (such as potential energy) are written out during the simulation | Any positive <code>INTEGER</code> number |
| Saving frequency<br>(configuration/trajectory) | <code>N_SAVE_CONF</code> | Represents how often (every <code>N_SAVE_CONF</code> cycles) the configuration/trajectory is written out during the simulation | Any positive <code>INTEGER</code> number |
| Maximum translational displacement | <code>MAX_TRANS</code> | Represents a scaling factor that controls translational movements<br>**NOTE**: the scaling factor is multiplied by the size parameter of the fluid | Any positive <code>FLOAT</code> number |
| Maximum translational displacement<br>(random configuration) | <code>MAX_TRANS_RD</code> | Represents a scaling factor that controls translational movements in the random configuration routine<br>**NOTE**: the scaling factor is multiplied by the size parameter of the fluid | Any positive <code>FLOAT</code> number |
| Maximum rotational displacement | <code>MAX_ROT</code> | Represents a parameter that controls rotational movements (in radians) | Any positive <code>FLOAT</code> number |
| Maximum rotational displacement<br>(random configuration) | <code>MAX_ROT_RD</code> | Represents a parameter that controls rotational movements (in radians) in the random configuration routine | Any positive <code>FLOAT</code> number |
| Probability of displacement moves | <code>PROBABILITY_MOV</code> | Represents the probability of choosing between NVT/&mu;VT moves, i.e., translation/rotation or insertion/deletion | Any positive <code>FLOAT</code> number between 0 and 1 |
| Probability of translation moves | <code>PROBABILITY_TRANS</code> | Represents the probability of choosing between translation or rotation | Any positive <code>FLOAT</code> number between 0 and 1 |
| Probability of insertion moves | <code>PROBABILITY_CREATE</code> | Represents the probability of choosing between insertion or deletion | Any positive <code>FLOAT</code> number between 0 and 1 |
| Translational acceptance threshold | <code>ACC_TRANSLATION</code> | Represents the acceptance threshold for adjusting translational movements<br>**NOTE**: during equilibration, <code>MAX_TRANS</code> is adjusted whenever the current acceptance ratio is above/below the threshold | Any positive <code>FLOAT</code> number 0 and 1 |
| Rotational acceptance threshold | <code>ACC_ROTATION</code> | Represents the acceptance threshold for adjusting rotational movements<br>**NOTE**: during equilibration, <code>MAX_ROT</code> is adjusted whenever the current acceptance ratio is above/below the threshold | Any positive <code>FLOAT</code> number 0 and 1 |
| Insertion acceptance threshold | <code>ACC_CREATION</code> | Represents the acceptance threshold for insertion movements<br>(not used) | Any positive <code>FLOAT</code> number 0 and 1 |
| Deletion acceptance threshold | <code>ACC_DESTRUCTION</code> | Represents the acceptance threshold for deletion movements<br>(not used) | Any positive <code>FLOAT</code> number 0 and 1 |
| Initial configuration type | <code>RANDOM_CONFIGURATION</code> | Represents the initial configuration of the system | <ul><li><code>.TRUE.</code> to generate a random configuration</li><li><code>.FALSE.</code> to read the initial configuration from an external file named <code>initial_configuration.xyz</code></li></ul> |
| Seed type | <code>RANDOM_SEED_LOGICAL</code> | Represents the seed type for pseudorandom number generator routines | <ul><li><code>.TRUE.</code> for a random seed</li><li><code>.FALSE.</code> for a fixed seed (ensures reproducibility) </li></ul> |
| Number of layers | <code>NUMBER_SLABS</code> | Represents the number of layers used to compute the density profile | Any positive <code>INTEGER</code> number |

<p align="justify">
  A few additional parameters must be configured to perform the GCMC simulation for the water system. The flags <code>POTENTIAL_SOL_ENABLED</code>, <code>POTENTIAL_MIE_ENABLED</code>, and <code>POTENTIAL_ASSOC_ENABLED</code> must be set to <code>.TRUE.</code> to ensure that the fluid–solid, dispersive fluid–fluid, and associative fluid–fluid interactions are properly computed. Furthermore, the flags <code>POTENTIAL_HS_ENABLED</code> and <code>POTENTIAL_SW_ENABLED</code>, which refer to the hard-sphere and square-well potentials for dispersive fluid–fluid interactions, must be set to <code>.FALSE.</code>. The parameter <code>SW_RANGE</code> controls the range of this square-well potential (not to be confused with the associative square-well potential).
</p>

<p align="justify">
  For the simulations presented in the paper, the Lorentz–Berthelot (LB) combining rules were used to compute the cross-interaction parameters between the solid and the fluid. These parameters are obtained by setting the flag <code>OVERWRITE_COMBININGR</code> to <code>.FALSE.</code>. If <code>OVERWRITE_COMBININGR</code> is set to <code>.TRUE.</code>, the LB rules are overridden by user-specified values stored in the variables <code>SIGMA_SF</code> (size parameter) and <code>EPSILON_SF</code> (energy parameter).
</p>

<p align="justify">
  Moreover, the flag <code>RELEASE_XY</code> controls whether translations along the <em>x</em>- and <em>y</em>-directions are decoupled from translations along the <em>z</em>-direction with respect to the maximum translational displacement parameter. The parameter <code>PROB_TRANSLATION_XY</code> defines the probability of attempting translations in the <em>x</em>–<em>y</em> plane relative to translations along the <em>z</em>-direction. In this case, it is recommended to set <code>RELEASE_XY</code> to <code>.FALSE.</code>.
</p>

<p align="justify">
  The random-configuration routine is based on a trial-and-error NVT algorithm in which particles are repeatedly inserted into the simulation box at a constant (user-defined) density until the target number of molecules (<code>NUMBER_PARTICLES</code>) is reached. If the NVT procedure alone fails to generate a valid configuration, an NPT algorithm may be used instead. This situation may occur at higher densities, where particle insertion becomes difficult due to the lack of available space. In such cases, it is advisable to first insert molecules at a lower density and subsequently compress the system to reach the desired initial density before performing the GCMC simulation.
</p>

<p align="justify">
  The NPT algorithm is enabled by setting <code>DO_NPT_RANDOM</code> to <code>.TRUE.</code>. It is controlled by the parameters <code>MAX_ATTEMPTS_NPT</code> (maximum number of NPT cycles), <code>MAX_ISO_RD</code> (maximum isotropic volume change), <code>MAX_ANISO_RD</code> (maximum anisotropic volume change), <code>PRESSURE_RANDOM</code> (target pressure in MPa), <code>PROBABILITY_ISO</code> (probability of selecting isotropic rather than anisotropic volume changes), <code>ACC_ISO</code> (acceptance threshold for isotropic volume changes), and <code>ACC_ANISO</code> (acceptance threshold for anisotropic volume changes). The anisotropic volume change is defined as a modification of one box dimension at a time while preserving the orthorhombic shape of the simulation box. This behavior is controlled by the parameter <code>MAX_DISTORTION</code>, which specifies the maximum allowed ratio between any two box lengths. Any attempted volume change that results in a box edge ratio larger than <code>MAX_DISTORTION</code> is rejected.
</p>

<p align="justify">
  As an additional feature, the user can compute the excess chemical potential by enabling the Widom insertion method. This is done by setting the flag <code>CONSIDER_WIDOM</code> to <code>.TRUE.</code>, which activates the Widom insertion routine. The frequency of Widom insertions is controlled by the parameter <code>WIDOM_FREQ</code>, meaning that the routine is executed every <code>WIDOM_FREQ</code> cycles.
</p>

<p align="justify">
  Finally, to perform a simulation under confinement (slit pores), the user must set the flag <code>CONSIDER_CONFINEMENT</code> to <code>.TRUE.</code>. If <code>CONSIDER_CONFINEMENT</code> is set to <code>.FALSE.</code>, the initial-configuration routine generates a cubic simulation box whose volume is determined from the prespecified initial density of the system.
</p>

## <a name="running"></a>Running the Code
