```
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣤⣴⣶⡆⠀⣶⣶⣦⣤⣤⣄⠀⢠⣾⣿⣦
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⢰⣿⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⡄⠘⢿⣿⠟
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣾⣿⣧⠀⢻⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⣿⠂⢠⣠⣤⣶⣦⡀
                                    ⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣇⠈⢿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⠏⢀⣿⣿⣿⣿⣿⣿⣦⡀
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣿⣿⡆⠘⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⡏⠀⣾⣿⣿⣿⣿⣿⣿⡿⠋⢀
                                    ⠀⠀⠀⣴⣿⣦⡀⠙⢿⣿⣿⣿⣿⣿⣿⡄⠸⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⡟⠀⣼⣿⣿⣿⣿⣿⣿⠟⢀⣴⣿⣧
                                    ⠀⠀⣼⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣿⣷⡀⢹⣿⣿⣿⡇⠀⣿⣿⣿⡿⠁⣰⣿⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣧
                                    ⠀⣼⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣧⠀⢻⣿⣿⡇⠀⣿⣿⣿⠃⢰⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⠀⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣇⠀⢿⣿⡇⠀⣿⣿⠇⢠⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠃
                                    ⣼⣶⣤⣄⡈⠙⠛⠿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⡆⠈⠛⠃⠀⠛⠋⠀⣾⣿⠟⠁⣠⣾⣿⣿⣿⣿⡿⠿⠛⠉⣀⣠⣴⣶⡄
                                    ⣿⣿⣿⣿⣿⣿⣶⣤⣀⡉⠙⠻⢿⣿⣿⣦⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⠁⢠⣾⣿⣿⠿⠛⠋⢁⣠⣴⣶⣿⣿⣿⣿⣿⣿⡀
                                    ⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣤⣀⠉⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠋⢁⣀⣤⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁ ⣠⣶⣄
                                    ⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⢻⣿⣿⡿
                                    ⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠂⠀⠙⠋
                                    ⠀⠀⠘⣿⣿⣿⣿⣿⠿⠛⠋⢁⣠⣤⣶⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋
                                    ⠀⠀⠀⠘⠟⠋⢉⣀⣤⣶⣿⣿⣿⣿⠟⠁⣠⣦⣄⡀⠀⠀⠀⠀⠀⠀⣤⣦⡈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠁
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⠟⠁⣠⣾⣿⣿⣿⣿⣿⣶⣶⣾⣧⠀⢻⣿⣿⣦⡈⠻⣿⣿⣿⣿⡿⠟⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠙⠿⣿⡟⠁⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠈⠿⢿⣿⣿⣦⡈⠻⠛⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠺⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⢀⣤⣤⡈⠙⠋⠁
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠻⠿⠿⠿⠿⠿⠿⠇⠀⣿⣿⣿⡇
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠋

                         /██   /██   /██   /██   /██████    /██████     /██████    /██      /██   /███████
                        | ██  | ██  | ███ | ██  |_  ██_/   /██__  ██   /██__  ██  | ███    /███  | ██__  ██
                        | ██  | ██  | ████| ██    | ██    | ██  \__/  | ██  \ ██  | ████  /████  | ██  \ ██
                        | ██  | ██  | ██ ██ ██    | ██    | ██        | ████████  | ██ ██/██ ██  | ███████/
                        | ██  | ██  | ██  ████    | ██    | ██        | ██__  ██  | ██  ███| ██  | ██____/
                        | ██  | ██  | ██\  ███    | ██    | ██    ██  | ██  | ██  | ██\  █ | ██  | ██
                        |  ██████/  | ██ \  ██   /██████  |  ██████/  | ██  | ██  | ██ \/  | ██  | ██
                         \______/   |__/  \__/  |______/   \______/   |__/  |__/  |__/     |__/  |__/
```
<p align="right"><b><sub><a href="https://github.com/LESC-Unicamp/Supplementary-materials/blob/main/Classical-Density-Functional-Theory-coupled-to-the-SAFT-VR-Mie-Equation-of-State-extension-to-associative-fluids/GCMC/CHANGELOG.md">Version: 1.0.0</a></sub></b></p>

<p align="center"><b>Authors</b></p>
<p align="center">
André de Freitas Gonçalves<br>
Nathan Barros de Souza<br>
Luís Fernando Mercier Franco<br></p>

# <p align="center"><b>Grand Canonical Monte Carlo</b> (GCMC):<br> associative fluids</p>

## Contents
1. [Disclaimer](#disclaimer)
2. [Overview](#overview)
3. [Features](#features)
4. [Language](#language)
5. [Building and Compiling](#installation)
6. [Data Input](#datainput)
7. [Files](#filesandfolders)
8. [Running the Code](#running)
9. [Reporting Errors](#reporting)
10. [Citing Us](#citation)

## <a name="disclaimer"></a>Disclaimer
<p align="justify">
The authors make no warranties about the use of this software. The authors hold no liabilities for the use of this software. The authors do not 
 recommend the use of this software whatsoever. The algorithm is made freely available to assist researchers in simulation studies involving associative fluids.
 All information contained herein regarding any specific methodology does not constitute or imply its endorsement or recommendation by the authors.
</p>

## <a name="overview"></a>Overview
<p align="justify">
  This Grand Canonical Monte Carlo (GCMC) algorithm was designed to evaluate the density profile of an associative fluid (water) confined in two-dimensional slit pores (graphite). The dispersive fluid–fluid interactions are described by the Mie potential, while the highly directional associative interactions (hydrogen bonding) are modeled using a spherical square-well potential. The solid–fluid interaction is represented by the Steele potential.
</p>

<p align="justify">
The figures below illustrate the geometry of the simulation box containing water molecules confined within a slit pore of width <b>30 Å</b> (along the <i>z</i>-direction) at a reduced chemical potential &mu;<sup>*</sup> = &mu; / (kT) = −14.364, where <em>k</em> is the Boltzmann constant and <em>T</em> is the system temperature.
</p>

| |
|:---:|
| |
| **Front View** showing water molecules within an orthorhombic simulation box confined along the _z_-direction. |
| ![paper_front](https://github.com/user-attachments/assets/d6294aee-85a4-4df4-be2b-117a9c04316a) |
| **Top View** of the simulation box highlighting its square cross-section. |
| ![paper_top](https://github.com/user-attachments/assets/fea7664f-8719-463e-ba6b-4a11f84a3728) |
| |

## <a name="features"></a>Features
<p align="justify">
The following features are supported in the current version:
</p>

1. Initial Configurations
    - Random Structure

2. Ensembles
    - Grand Canonical (&mu;VT)

4. Moves
    - Translation (NVT)
    - Rotation (NVT)
    - Insertion (&mu;VT)
    - Deletion (&mu;VT)

5. Force Fields
    - Mie (for dispersive fluid-fluid interactions)
    - Square Well (for associative fluid-fluid interactions)
    - Steele (for solid-fluid interactions)

## <a name="language"></a>Language
<p align="justify">
  The main program, subroutines, and modules contain some explanatory comments and are mainly written in Fortran 95. The user can look for more information on Fortran language <a href="https://docs.oracle.com/cd/E19957-01/806-3591/C_f95.html">here</a>.
</p>

## <a name="installation"></a>Building and Compiling
<p align="justify">
  Firstly, you must clone this GitHub repository using the command below:
</p>

```
> git clone https://github.com/LESC-Unicamp/Supplementary-materials/
```

<p align="justify">
  After that, change to the repository directory on your device and open the <code>/src/</code> folder:
</p>

```
cd Supplementary-materials/Classical-Density-Functional-Theory-coupled-to-the-SAFT-VR-Mie-Equation-of-State-extension-to-associative-fluids/GCMC/src/
```

<p align="justify">
  The <code>/src/</code> folder contains a 'Makefile' that you can use to compile the standard version of the code.
</p>

<p align="justify">
  To compile it, first remove any object and module files using the <i>clean</i> command:
</p>
  
```
> make clean
```

<p align="justify">
  Then, to compile the source code, run the command below:
</p>

| **Compilation type** | **Command** |
|:---:|:---:|
| <a href="https://github.com/LESC-Unicamp/Supplementary-materials/blob/main/Classical-Density-Functional-Theory-coupled-to-the-SAFT-VR-Mie-Equation-of-State-extension-to-associative-fluids/GCMC/src/makefile">Standard</a> | ```make -f makefile``` |

<p align="justify">
  Please note that although the compilation includes a parallelization option (OpenMP), it has not yet been implemented in the code. This feature is reserved for future versions.
</p>

<p align="justify">
  This command will produce an executable named <code>gcmc_mie_assoc.out</code>, which can be found in the folder <code>/bin/</code> in the GCMC repository directory. Before running the program, there are a few initialization variables and options you need to set up.
</p>

## <a name="datainput"></a>Data Input

<p align="justify">
  Apart from the executable file, the <code>/bin/</code> folder contains an initialization file named <code>parameters.ini</code> that must be configured. The available options are straightforward and include comments; however, we provide a brief explanation of some of them below.
</p>

| Name<br> ______________________ | String Name<br> _________________________________ | Definition<br> _______________________________ | Options<br> _________________________________________________ |
|:---:|:---:| --- | --- |
| Number of particles | <code>NUMBER_PARTICLES</code> | Represents the initial number of particles/molecules (N) in GCMC simulations | Any positive, non-zero <code>INTEGER</code> number |
| Number density | <code>DENSITY</code> | Represents the initial number density (&rho;) of the system in [1/Å³] | Any positive, non-zero <code>FLOAT</code> number |
| Temperature | <code>TEMPERATURE</code> | Represents the temperature (T) of the system in [K] | Any positive, non-zero <code>FLOAT</code> number |
| Reduced chemical potential | <code>RED_CHEMICAL_POT</code> | Represents the target reduced chemical potential (&mu;<sup>*</sup>) of the system in kT units | Any <code>FLOAT</code> number |
| Pore width | <code>PORE_WIDTH</code> | Represents the width in [Å] of the simulation box along the _z_-direction (confinement) | Any positive <code>FLOAT</code> number |
| Pore height | <code>PORE_HEIGHT</code> | Represents the height in [Å] of the simulation box along the _x_-direction (PBC)<br>**NOTE**: The length along the _y_-direction is calculated from the provided initial number density | Any positive <code>FLOAT</code> number |
| Solid density | <code>SOLID_DENSITY</code> | Represents the density of the solid phase (graphite) in [1/Å³] | Any positive <code>FLOAT</code> number |
| Interlayer spacing | <code>INTERLAYER_SPACING</code> | Represents the distance in [Å] between adjacent graphene layers in the solid phase | Any positive <code>FLOAT</code> number |
| Size parameter<br>(solid) | <code>SIGMA_SOLID</code> | Represents the size parameter of the solid in [Å]<br>**NOTE**: used in the Lorentz combining rule to obtain the solid-fluid interaction parameter (Mie potential) | Any positive <code>FLOAT</code> number |
| Energy parameter<br>(solid) | <code>EPSILON_SOLID</code> | Represents the energy parameter (divided by _k_) of the solid in [K]<br>**NOTE**: used in the Berthelot combining rule to obtain the solid-fluid interaction parameter (Mie potential) | Any positive <code>FLOAT</code> number |
| Size parameter<br>(fluid) | <code>SIGMA_FLUID</code> | Represents the size parameter of the fluid in [Å] | Any positive <code>FLOAT</code> number |
| Energy parameter<br>(fluid) | <code>EPSILON_FLUID</code> | Represents the energy parameter (divided by _k_) of the fluid in [K] | Any positive <code>FLOAT</code> number |
| Cutoff radius<br>(Mie potential) | <code>CUTOFF_RADIUS_MIE</code> | Represents the cutoff radius in [Å] for dispersive fluid-fluid interactions described by the Mie potential | Any positive <code>FLOAT</code> number |
| Attractive range<br>(Mie potential) | <code>ARANGE</code> | Represents the attractive exponent of the Mie potential | Any positive <code>FLOAT</code> number |
| Repulsive range<br>(Mie potential) | <code>RRANGE</code> | Represents the repulsive exponent of the Mie potential | Any positive <code>FLOAT</code> number |

| Energy parameter<br>(association) | <code>EPSILON_WATER</code> | Represents the energy parameter of the fluid (association) | Any positive <code>FLOAT</code> number |
| Cutoff radius<br>(SW potential) | <code>CUTOFF_RADIUS_WATER</code> | Represents the cutoff radius for associative fluid-fluid interactions described by the square-well potential | Any positive <code>FLOAT</code> number |
| Association sites<br>(position) | <code>RADIUS_SITES</code> | Represents a scaling factor that positions the association sites inside a sphere of diameter <code>SIGMA_FLUID</code><br>**NOTE**:  | Any <code>FLOAT</code> number |
| Association sites<br>(angle) | <code>WATER_ANGLE</code> | Represent | Any <code>FLOAT</code> number |
| Pore height | <code></code> | Represent | Any <code>FLOAT</code> number |

POTENTIAL_SOL_ENABLED=true POTENTIAL_MIE_ENABLED=true POTENTIAL_ASSOC_ENABLED=true
POTENTIAL_HS_ENABLED=false POTENTIAL_SW_ENABLED=false SW_RANGE
OVERWRITE_COMBININGR

